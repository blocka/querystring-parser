/*!
 * QueryString - Standalone query-string parser for JavaScript
 * Copyright 2011 murdoc <murdoc@raidrush.org>
 *
 * This library is free software: you can redistribute it and/or
 * modify it under the terms of the GNU Lesser General Public
 * License as published by the Free Software Foundation, either
 * version 3 of the License, or (at your option) any later version.
 *
 * This library is distributed in the hope that it will be useful,
 * but WITHOUT ANY WARRANTY; without even the implied warranty of
 * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
 * Lesser General Public License for more details.
 *
 * You should have received a copy of the GNU Lesser General Public
 * License along with this library. If not, see <http://www.gnu.org/licenses/>.
 */
"use strict";(function(j){var o=1,c=2,A=4,e=8,B=16,E=32;var k=/[=\[\]]/,z=/^[0-9]+$/;var v=Object.prototype.toString;var n=v.call(""),G=v.call({}),w=v.call([]),d=v.call(0),u=v.call(true),s=v.call(new Date);var i={next:function r(){if(this.offs+1>this.slen){return null}return this.data.charAt(this.offs++)},tokenize:function a(M,O){var N=[],K,J=M.split(O||"&");for(var I=0,H=J.length;I<H;++I){this.data=J[I];this.slen=this.data.length;this.offs=0;while(K=this.next()){switch(K){case"=":N.push(o);break;case"[":N.push(c);break;case"]":N.push(A);break;default:var L=K;while(K=this.next()){if(k.test(K)){--this.offs;break}L+=K}if(z.test(L)){N.push(E,parseInt(L))}else{N.push(B,decodeURIComponent(L))}}}N.push(e)}delete this.data,this.slen,this.offs;return N}};var y={parse:function q(J,K){this.delim=K||"&";this.tokens=i.tokenize(J,K);var I={};while(this.tokens.length){this.expect(B);var H=this.next();if(typeof I[H]==="undefined"){I[H]=this.init()}this.collect(I[H],I,H)}return I},collect:function m(K,H,J){var I;switch(I=this.next()){case c:this.access(K);break;case o:this.expect(B|E);H[J]=this.next();this.expect(e);break;case e:H[J]=true;break;default:throw new Error("Syntax error: unexpected "+this.lookup(I)+', expected "[", "=" or "'+this.delim+'"')}},access:function g(M){var L;switch(L=this.next()){case A:var K=M.push(this.init())-1;this.collect(M[K],M,K);break;case E:var I=this.next();this.expect(A);if(M.length<=I){for(var J=M.length;J<I;++J){M.push(null)}M.push(this.init())}this.collect(M[I],M,I);break;case B:var H=this.next();this.expect(A);if(typeof M[H]=="undefined"){M[H]=this.init()}this.collect(M[H],M,H);break;default:throw new Error("Syntax error: unexpected "+this.lookup(L)+', expected "]", (number) or (string)')}},ahead:function b(H){return this.tokens[H||0]},init:function x(){var H;switch(this.ahead()){case c:switch(H=this.ahead(1)){case A:case E:return[];case B:return{};default:throw new Error("Syntax error: unexpected "+this.lookup(H)+', expecting "]", (number) or (string)')}break;default:return}},lookup:function D(H){switch(H){case o:return'"="';case c:return'"["';case A:return'"]"';case B:return"(string)";case E:return"(number)";case e:return'"'+this.delim+'"';default:return"?("+H+")?"}},next:function r(){return this.tokens.length?this.tokens.shift():null},expect:function f(J){if(this.tokens.length&&(this.tokens[0]&J)===0){var H=[];for(var I=0;I<=32;I+=I){if(I&J!==0){H.push(D(I))}}throw new Error("Syntax error: unexpected "+this.lookup(this.tokens[0])+", expecting "+H.join(" or "))}if(this.tokens.length){this.tokens.shift()}}};var l={parse:function q(I,L){this.delim=L||"&";var H=[],K;for(var J in I){if(!I.hasOwnProperty(J)){continue}if((K=this.serialize(I[J],J))!==""){H.push(K)}}return H.join(this.delim)},serialize:function t(I,H){if(typeof I==="undefined"||I===null){return""}switch(v.call(I)){case s:return H+"="+(+I);case n:I=this.encode(I);case d:return H+"="+I;case u:return H+"="+(I?1:0);case w:case G:return this.access(I,H);default:throw new Error('Parse error: value for key "'+H+'" is not serializable')}},access:function g(L,J){var H=[];if(v.call(L)===w){for(var K=0,I=L.length;K<I;++K){this.handle(H,J,L[K],K)}}else{for(var K in L){if(L.hasOwnProperty(K)){this.handle(H,J,L[K],K)}}}return H.join(this.delim)},handle:function C(H,I,K,L){var J;if((J=this.serialize(K,I+"["+L+"]"))!==""){H.push(J)}},encode:function h(H){return encodeURIComponent(H)}};var F={decode:function p(H,I){return y.parse(H,I)},encode:function h(H,I){return l.parse(H,I)}};if(typeof module!=="undefined"){module.exports=F}if(typeof window!=="undefined"){window.QueryString=F}})();